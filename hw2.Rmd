Homework 1 - [Your team name here]
========================================================

### Task 0 - Load the data

```{r}
suppressMessages(library(dplyr))
load("lego_sales.RData")
```

### Task 1 - Tidying the data

Intialize the Data Frame
```{r}
# find top level names
name0 = sales %>% unlist(recursive=FALSE) %>% names() %>% unique()

# identify number of rows based on maxiumum number of each catagory
sum_n = 
    sapply(name0, function(x) 
        sapply(sales, function(y) 
            length(y[[x]]))) %>% 
    colSums()

# identify subcatagory names
cat_name = 
    sapply(name0, function(x)
        sapply(sales, function(y)
            y[[x]] %>% 
            unlist() %>%
            names()) %>%
        unlist() %>% 
        unique()) 

# create list of column names
cat_name = cat_name[!(sapply(cat_name, is.null))]
name = c(name0, unlist(cat_name, use.names = FALSE))
    
# intialize the data frame given the extents discovered above
lego_df = matrix(nrow = max(sum_n), ncol = length(name)) %>%
    data.frame() %>% 
    tbl_df() %>%
    setNames(name)

lego_df$'hobbies' = as.list(lego_df$'hobbies')
```

Create a couple of helper functions
```{r}
# A 'safe' rep function that returns NA value when encountering NULL
rep_safe = function(x, t) {
    if (is.null(x) | is.list(x)) {
        rep(NA, t) 
    } else if (length(x) != 1) {
        list(x)[rep(1,t)]
    } else {
        rep(x, t)
    }
}
```

Loop over and fill the data frame
```{r}
name_max = 'purchases'
for (n in name0) {
    lego_df[[n]] = 
        sapply(sales, function(x) 
            rep_safe(x[[n]], length(x[[name_max]]))) %>%
        unlist(recursive=FALSE)
    for (c in cat_name[[n]]) {
        lego_df[[c]] =
            sapply(sales, function(x) 
                sapply(x[[n]], function(y) y[[c]]))  %>%
            unlist()
    }
}
```

## Task 2 - Processing the data

1. What was the most common first name of purchasers? Last name?

The most common first name is 
```{r}
```

2. What are the five most popular lego sets based on these data?

```{r}
```

3. Which five customers have spent the most money so far and how much have they spent?

```{r}
```

4. Which lego theme has made the most money for lego?

```{r}
```

5. Do men or women buy more lego sets (per person) on average?

```{r}
```

6. What are the five most popular hobbies of lego purchasers?

```{r}
```

7. How many total pieces have been purchased from lego by these customers?

```{r}
```

8. What state has spent the most money on legos? Hint - customer area codes may prove useful for this.

```{r}
```
